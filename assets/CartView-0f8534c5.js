import{_ as B,Y as E,Z as F,aw as I,x as S,o as f,ah as x,a2 as i,a3 as u,c as a,a5 as l,X as q,aa as y,aD as D,a7 as t,a8 as $,a9 as N,aE as z,V as P,ac as n,K as p,a6 as j,au as A,av as R}from"./index-37d901bc.js";import{V as T,a as _}from"./VRow-43f02446.js";/* empty css              */const v=d=>(A("data-v-989e9411"),d=d(),R(),d),K={style:{background:"#ECEFF1",width:"100%",height:"102%"}},L=v(()=>t("thead",null,[t("tr",{style:{background:"#E1F5FE"}},[t("th",{class:"text-center border-right"},"商品圖"),t("th",{class:"text-center border-right"},"價格"),t("th",{class:"text-center border-right"},"數量"),t("th",{class:"text-center border-right"},"小計"),t("th",{class:"text-center"},"移除")])],-1)),U={class:"d-flex justify-start align-center",style:{height:"150px"}},X={class:"ml-3"},Y={class:"price-text"},Z={class:"text-center"},G={class:"text-center"},H={class:"text-center"},J={key:0,style:{height:"360px"}},M=v(()=>t("td",{colspan:"6",class:"text-center"},"沒有商品",-1)),O=[M],Q={style:{"font-size":"1.5rem","font-weight":"500",color:"#1A237E"}},W={__name:"CartView",setup(d){const h=E(),g=F(),b=I(),o=S([]),m=async(s,c)=>{try{const{data:e}=await x.post("/users/cart",{product:s,quantity:c}),r=o.value.findIndex(V=>V.product._id===s);o.value[r].quantity+=c,o.value[r].quantity<=0&&o.value.splice(r,1),g.cart=e.result}catch(e){h({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}},C=f(()=>o.value.reduce((s,c)=>s+c.quantity*c.product.price,0)),k=f(()=>o.value.length>0&&!o.value.some(s=>!s.product.sell)),w=async()=>{try{await x.post("/orders"),g.cart=0,b.push("/orders")}catch(s){console.log(s),h({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(async()=>{try{const{data:s}=await x.get("/users/cart");o.value.push(...s.result)}catch(s){h({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(s,c)=>(i(),u("div",K,[a(T,{class:"d-flex flex-column align-center"},{default:l(()=>[a(_,{cols:"12"}),a(_,{cols:"11",md:"8",class:"d-flex",style:{"padding-top":"7rem",color:"#4ea1d3","font-size":"1.5rem"}},{default:l(()=>[a(q,{icon:"mdi-cart"}),y("購物車 ")]),_:1}),a(_,{cols:"11",md:"8"},{default:l(()=>[a(D,{style:{border:"dotted 1px #999"}},{default:l(()=>[L,t("tbody",null,[(i(!0),u($,null,N(o.value,e=>(i(),u("tr",{key:e._id,class:z({"bg-red-lighten-5":!e.product.sell})},[t("td",U,[t("span",null,[a(P,{src:e.product.image,cover:"",width:"90","aspect-ratio":"1"},null,8,["src"])]),t("span",X,n(e.product.name),1)]),t("td",Y,n("$"+e.product.price),1),t("td",Z,[a(p,{color:"primary",variant:"text",icon:"mdi-minus",onClick:r=>m(e.product._id,-1)},null,8,["onClick"]),y(" "+n(e.quantity)+" ",1),a(p,{color:"primary",variant:"text",icon:"mdi-plus",onClick:r=>m(e.product._id,1)},null,8,["onClick"])]),t("td",G,n(e.quantity*e.product.price),1),t("td",H,[a(p,{color:"#BDBDBD",variant:"text",icon:"mdi-delete",class:"icon-delete",onClick:r=>m(e.product._id,e.quantity*-1)},null,8,["onClick"])])],2))),128)),o.value.length===0?(i(),u("tr",J,O)):j("",!0)])]),_:1})]),_:1}),a(_,{cols:"11",md:"8",class:"d-flex justify-end my-8",style:{background:"#ECEFF1"}},{default:l(()=>[t("p",Q,"總金額："+n("$"+C.value),1),a(p,{color:"danger",variant:"elevated",onClick:w,disabled:!k.value,class:"ml-6"},{default:l(()=>[y("結帳")]),_:1},8,["disabled"])]),_:1})]),_:1})]))}},at=B(W,[["__scopeId","data-v-989e9411"]]);export{at as default};
